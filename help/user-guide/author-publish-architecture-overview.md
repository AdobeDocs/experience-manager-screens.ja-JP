---
title: アーキテクチャの作成とパブリッシュの概要
seo-title: アーキテクチャの作成とパブリッシュの概要
description: AEM Screensのアーキテクチャは、従来のAEM Sitesのアーキテクチャに似ています。 コンテンツはAEMオーサーインスタンスで作成され、複数のパブリッシュインスタンスに転送複製されます。 アーキテクチャの概要を作成および公開する方法の詳細については、このページを参照してください。
seo-description: AEM Screensのアーキテクチャは、従来のAEM Sitesのアーキテクチャに似ています。 コンテンツはAEMオーサーインスタンスで作成され、複数のパブリッシュインスタンスに転送複製されます。 アーキテクチャの概要を作成および公開する方法の詳細については、このページを参照してください。
uuid: 19bac3de-8938-4339-82f0-6ccb932b6684
content-type: reference
topic-tags: administering
products: SG_EXPERIENCEMANAGER/6.5/SCREENS
discoiquuid: 112404de-5a5a-4b37-b87c-d02029933c8a
docset: aem65
translation-type: tm+mt
source-git-commit: ad7f18b99b45ed51f0393a0f608a75e5a5dfca30

---


# アーキテクチャの作成とパブリッシュの概要 {#author-and-publish-architectural-overview}

このページでは、次のトピックについて説明します。

* **公開サーバの概要**
* **アーキテクチャの概要**
* **登録手続**

## 前提条件 {#prerequisites}

作成者サーバとパブリッシュサーバを使い始める前に、次の事項に関する事前の知識が必要です。

* **AEMトポロジ**
* **AEM Screensプロジェクトの作成と管理**
* **デバイス登録プロセス**

>[!NOTE]
>
>このAEM Screens機能は、AEM 6.4 Screens機能パック2をインストールしている場合にのみ使用できます。 この機能パックにアクセスするには、アドビサポートに連絡してアクセス権をリクエストする必要があります。アクセス権が付与されると、パッケージ共有から機能パックをダウンロードできるようになります。

## 概要 {#introduction}

AEM Screensのアーキテクチャは、従来のAEM Sitesのアーキテクチャに似ています。 コンテンツはAEMオーサーインスタンスで作成され、複数のパブリッシュインスタンスに転送複製されます。 AEM Screensデバイスは、ロードバランサーを介してAEM発行ファームに接続できるようになりました。 複数のAEM発行インスタンスを追加して、発行ファームの拡大/縮小を続行できます。

*例えば*、AEM Screensコンテンツ作成者は、発行ファームとやり取りするように設定された特定のデバイスのオーサリングシステム上でコマンドを発行するか、AEM Screensコンテンツ作成者は、発行ファームとやり取りするように設定されたデバイスに関する情報を取得します。

次の図に、作成者環境と発行環境を示します。

![screen_shot_2019-03-04at30236pm](assets/screen_shot_2019-03-04at30236pm.png)

## 建築設計 {#architectural-design}

次の5つのアーキテクチャコンポーネントがあり、このソリューションを容易にします。

* ***デバイス別に表示するため*** 、作成者から公開へのコンテンツの複製

* ***バイナリ*** コンテンツの公開（デバイスから受信）から作成者への逆複製
* ***特定の*** REST APIを使用した作成者から発行へのコマンドの送信
* ***デバイス情報*** の更新とコマンドを同期するためのパブリッシュインスタンス間のメッセージング
* ***特定の*** REST APIを介してデバイス情報を取得するための発行インスタンスの作成者によるポーリング

### コンテンツと構成のレプリケーション（転送） {#replication-forward-of-content-and-configurations}

標準のレプリケーションエージェントは、画面チャネルのコンテンツ、場所の設定、およびデバイスの設定を複製するために使用します。 これにより、チャネルの更新を行う前に、作成者はチャネルのコンテンツを更新し、必要に応じて、ある種の承認ワークフローを実行できます。 レプリケーションエージェントは、発行ファームの各発行インスタンスに対して作成する必要があります。

次の図に、レプリケーション・プロセスを示します。

![screen_shot_2019-03-04at33935pm](assets/screen_shot_2019-03-04at33935pm.png)

>[!NOTE]
>
>レプリケーションエージェントは、発行ファームの各発行インスタンスに対して作成する必要があります。

### 画面複製エージェントとコマンド {#screens-replication-agents-and-commands}

カスタム画面固有の複製エージェントが作成され、作成者インスタンスからAEM Screensデバイスにコマンドが送信されます。 AEM発行インスタンスは、これらのコマンドをデバイスに転送する媒介として機能します。

これにより、作成者はデバイスの管理（デバイスの更新の送信、作成者環境からのスクリーンショットの取得など）を継続できます。 AEM Screensレプリケーションエージェントには、標準のレプリケーションエージェントなど、カスタムのトランスポート設定があります。

### 発行インスタンス間のメッセージ {#messaging-between-publish-instances}

多くの場合、コマンドは1回だけデバイスに送信されます。 ただし、負荷分散された発行アーキテクチャでは、デバイスが接続している発行インスタンスは不明です。

したがって、作成者インスタンスはすべての発行インスタンスにメッセージを送信します。 ただし、デバイスに転送されるメッセージは1つだけです。 正しいメッセージングを確実に行うために、一部の通信はパブリッシュインスタンス間で行われる必要があります。 これは、*Apache activeMQ Artemisを使用して行います。 *各発行インスタンスは、OakベースのSling検出サービスを使用して疎結合されたTopologyに配置され、各発行インスタンスが通信し、単一のメッセージキューを作成できるようにActiveMQが設定されます。 Screensデバイスは、ロードバランサーを介して発行ファームをポーリングし、キューの先頭からコマンドを取得します。

### リバースレプリケーション {#reverse-replication}

多くの場合、コマンドの後に、Screensデバイスから何らかの応答が発言者インスタンスに転送される必要があります。 このAEM逆複製を実現するには ***、*** 「Reverse Replication」が使用されます。

* 標準の複製エージェントと画面の複製エージェントと同様に、各発行インスタンスに逆複製エージェントを作成します。
* ワークフローランチャー設定は、発行インスタンスで変更されたノードをリッスンし、次にワークフローをトリガーして、デバイスの応答を発行インスタンスのアウトボックスに配置します。
* このコンテキストの逆複製は、デバイスが提供するバイナリデータ（ログファイルやスクリーンショットなど）に対してのみ使用されます。 非バイナリデータは、ポーリングによって取得されます。
* AEM作成者インスタンスからポーリングされた逆複製が応答を取得し、作成者インスタンスに保存します。

### 発行インスタンスのポーリング {#polling-of-publish-instances}

オーサーインスタンスは、ハートビートを取得し、接続されたデバイスのヘルスステータスを知るために、デバイスをポーリングできる必要があります。

ロードバランサーにpingを送信し、パブリッシュインスタンスにルーティングされるデバイス。 次に、デバイスのステータスは、すべてのアクティブなデバイス用に提供された公開API @ **api/screens-dcc/devices/stati** （アクティブなデバイス用）および **** api/screens-dcc/devices/&lt;device_id&gt;/status.json（単一のデバイス用）を通じて、発行インスタンスによって公開されます。

オーサーインスタンスは、すべてのパブリッシュインスタンスをポーリングし、デバイスステータス応答を1つのステータスにマージします。 作成者に対して投票を行うスケジュール済み `com.adobe.cq.screens.impl.jobs.DistributedDevicesStatiUpdateJob` のジョブは、Cron形式に基づいて設定できます。

## 登録 {#registration}

登録は引き続きAEM作成者インスタンスから開始されます。 AEM Screensデバイスは作成者インスタンスを指し、登録が完了します。

デバイスが作成者環境に登録されると、デバイス設定とチャネル/スケジュールの割り当てがAEM発行インスタンスに複製されます。 次に、AEM Screensデバイス設定が更新され、AEM発行ファームの前にあるロードバランサーを指すようになります。 これは1回限りの設定を目的としており、Screensデバイスが公開環境に正常に接続されると、引き続き作成者環境からのコマンドを受け取ることができ、Screensデバイスを作成者環境に直接接続する必要はありません。

![screen_shot_2019-02-25at15218pm](assets/screen_shot_2019-02-25at15218pm.png)

### 次の手順 {#the-next-steps}

AEM Screensでの作成者と公開の設定のアーキテクチャデザインについて詳しくは、「AEM Screens用の作成者と公開 [の設定](author-and-publish.md) 」を参照してください。
