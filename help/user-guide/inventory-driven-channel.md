---
title: 在庫主導型チャネル
seo-title: 在庫主導型チャネル
description: 'null'
seo-description: 'null'
page-status-flag: never-activated
uuid: a7e7aa08-8f9e-4458-bdce-225cf29a6da4
contentOwner: jsyal
discoiquuid: 9989ef4c-9fdd-4bf2-9f7c-0c74a9cc4e7f
docset: aem65
translation-type: ht
source-git-commit: ad7f18b99b45ed51f0393a0f608a75e5a5dfca30

---


# 在庫主導型チャネル {#inventory-driven-channel}

## 在庫主導型チャネルの使用の手引き {#getting-started-with-inventory-driven-channels}

ここでは、Google シートを使用したデータ主導型アセット変更の作成と管理に重点を置いた使用例について説明します。

### 前提条件 {#preconditions}

この使用例を開始する前に、以下をおこなう方法を理解しておく必要があります。

* **[チャネルの作成と管理](managing-channels.md)**
* **[ロケーションの作成と管理](managing-locations.md)**
* **[スケジュールの作成と管理](managing-schedules.md)**
* **[デバイスの登録](device-registration.md)**

### 主要なアクター {#primary-actors}

コンテンツ作成者

### 用語 {#terminolgies}

以下では、様々な使用例でのプロジェクトの理解とセットアップに重要な役割を果たす用語について説明します。

**アクティビティ**：カテゴリを指します。

**領域**：プロジェクト名

**オーディエンス**：データの場所

**ブランド**：プロジェクトの概要を指します。

**セグメント**：ターゲット設定しようとしているアセットのコンテナを指します。

### 基本フロー：プロジェクトのセットアップ {#basic-flow-setting-up-the-project}

>[!NOTE]
>
>**前提条件：**
>
>プロジェクトにおけるデータ主導型アセット変更のセットアップと使用の詳細に立ち入る前に、シーケンスチャネルを含んだ AEM Screens プロジェクトを作成してください。デモ用に、**DataDrivenAsset** というタイトルのプロジェクトを作成し、**DataDrivenRestaurant**、**DataDrivenTextOverlay**、**DataDrivenWeather**、**DataDrivenRetail** というタイトルのシーケンスチャネルをプロジェクトに追加します（下図を参照）。
>
>4 つの異なるチャネルを作成するのは、あくまでデモ目的であり、様々なチャネルでの 4 つの異なる使用例を紹介するためです。1 つの使用例にのみ従えばよい場合は、1 つのシーケンスチャネルのみ作成してください。

![screen_shot_2019-05-01at42043pm](assets/screen_shot_2019-05-01at42043pm.png)

以下では、AEM Screens プロジェクトにおける Google シートを使用したデータ主導型アセット変更の作成と管理に関するサンプルプロジェクトを作成します。

## 手順 1：データベースのセットアップ {#step-setting-up-database}

>[!CAUTION]
>
>次の例では、値の取得先となるサンプルデータベースシステムとして Google シートを使用していますが、この Google シートはあくまで説明用のものです。アドビでは、実稼働環境への Google シートの使用はお勧めしません。
>
>詳しくは、Google ドキュメントの [Get an API Key](https://developers.google.com/maps/documentation/javascript/get-api-key) を参照してください。

1. Google Docs にログインします。

   >[!NOTE]
   >
   >新しい Google シートを作成するには、まず、Google ドライブにアカウントが必要です。

1. 新しい空白のスプレッドシートから開始します。Google シートにコンテンツを追加して保存します。デモ用に、この Google シートに **ContextHubDemo** という名前を付けます。
1. Google シートの右上隅にある「**共有**」をクリックして、**他のユーザーと共有**&#x200B;ダイアログボックスを開きます。「**アドバンス**」をクリックし、設定を「**オン - リンクを知っている全員**」に変更します（下図を参照）。

   この手順により、Google シートの値にアクセスできるようになります。

   ![screen_shot_2019-04-22at115829am](assets/screen_shot_2019-04-22at115829am.png)

1. 前の手順で「**保存**」をクリックすると、Google シートのリンクが表示されるようになります。後で参照できるように「保存」をクリックし、「**完了**」をクリックします。

   ![screen_shot_2019-04-22at120242pm](assets/screen_shot_2019-04-22at120242pm.png)

>[!CAUTION]
>
>以下の例では、Google シートを説明目的で使用しています。アドビでは、実稼働環境への Google シートの使用はお勧めしません。

## 手順 2：Google Sheets REST API の有効化 {#step-enabling-the-google-sheets-rest-apis}

Google シートをセットアップしたら、値にアクセスするために Google Sheets REST API を有効する必要があります。

Google シートの REST API を有効にする方法については、Google API のドキュメントを参照してください。

1. [Google API コンソール](https://console.developers.google.com/apis/credentials)に移動します。「**作成**」をクリックして、新しいプロジェクトを作成します。

   ![screen_shot_2019-04-22at125028pm](assets/screen_shot_2019-04-22at125028pm.png)

1. 「**プロジェクト名**」に「**AssetChange**」と入力し、「**作成**」をクリックします。
1. プロジェクトを作成したら、API キーをセットアップする必要があります。「**認証情報を作成**」をクリックし、「API キー」を選択して、プロジェクトの API キーを生成します。後で参照できるように API キーを保存します。

   >[!NOTE]
   >
   >このデモプロジェクトでは、無料の Google API キーを使用します。価格設定や制限について詳しくは、Google ドキュメント（**API キーの使用**）を参照してください。

### Google シートのセットアップの確認 {#verifying-the-setup-of-google-sheets}

```
Verify the data in your Google Sheets using the steps below
```

[https://sheets.googleapis.com/v4/spreadsheets/](https://sheets.googleapis.com/v4/spreadsheets/)&lt;シート id&gt;/values/Sheet1?key=&lt;API キー&gt;

次に例を示します。

Google シートのリンクが&#x200B;*次のような場合、*

`https://docs.google.com/spreadsheets/d/1Ksd125lAsDd0_wnMWgLNUiEpKOUPaok7xfh64s-VO7M/edit?usp=sharing`

**シート ID** は `1Ksd125lAsDd0_wnMWgLNUiEpKOUPaok7xfh64s-VO7M` になります。

**API キー**&#x200B;は `AIzaSyAfoANOeLkFCCyohjL8cOdJLhrhGefqEy8` になります。

これらの値を上記の構文に追加すると、次のようになります。

`https://sheets.googleapis.com/v4/spreadsheets/1Ksd125lAsDd0_wnMWgLNUiEpKOUPaok7xfh64s-VO7M/values/Sheet1?key=AIzaSyAfoANOeLkFCCyohjL8cOdJLhrhGefqEy8`

これで、シートのデータを表示できるようになります。

## 手順 3：Google シートのコンテンツを取得するための AEM の設定 {#step-configuring-aem-to-fetch-the-content-of-the-google-sheets}

ここでは、Google シートからコンテンツを取得するように Adobe Experience Manager（AEM）を設定する方法について説明します。

1. AEM インスタンスに移動し、左側のサイドバーにあるツールアイコンをクリックします。**サイト**／**ContextHub** をクリックします（下図を参照）。

   ![screen_shot_2019-04-22at53222pm](assets/screen_shot_2019-04-22at53222pm.png)

1. **新しい ContextHub ストア設定を作成する**

   1. **グローバル**／**デフォルト**／**ContextHub 設定**&#x200B;に移動します。

   1. **作成／設定コンテナ**&#x200B;をクリックし、タイトルに「ContextHubDemo」と入力します。

   1. **ContextHubDemo**／**ContextHub ストア設定...** に&#x200B;**移動し**&#x200B;て、**設定ウィザード**&#x200B;を開きます。
   1. 「**タイトル**」に「**Google Sheets**」、「**ストア名**」に「**googlesheets**」、「**ストアの種類**」に「**contexthub.generic-jsonp**」と、それぞれ入力します。
   1. 「**次へ**」をクリックします。
   1. 固有の JSON 設定を入力します。例えば、デモ目的では次の設定を使用できます。
   1. 「**保存**」をクリックします。

   ```
   {
     "service": {
       "host": "sheets.googleapis.com",
       "port": 80,
       "path": "/v4/spreadsheets/<your sheet it>/values/Sheet1",
       "jsonp": false,
       "secure": true,
       "params": {
         "key": "<your API key>"
       }
     },
     "pollInterval": 3000
   }
   ```

   >[!NOTE]
   >
   >上記のサンプルコードで、**pollInterval** は、値が更新される頻度をミリ秒単位で定義します。
   >
   >
   >上記の JSON コードの該当するプレースホルダーを、**手順 1：データベースのセットアップ**&#x200B;で取得した実際の *&lt;シート ID&gt;* と *&lt;API キー&gt;* に置き換えます。

   >[!CAUTION]
   Google シートのストア設定を従来のフォルダー以外（例えば、独自のプロジェクトフォルダー内など）で作成した場合、ターゲティングは初期状態では機能しません。
   Google シートのストア設定を従来のグローバルフォルダー以外で指定する場合は、「**ストア名**」を「**segmentation**」に、「**ストアの種類**」を「**aem.segmentation**」に、それぞれ設定する必要があります。さらに、上記の JSON 設定を定義する手順をスキップする必要があります。

1. **アクティビティにブランドを作成する**

   1. AEM インスタンスで、**パーソナライゼーション**／**アクティビティ**&#x200B;に移動します。

   1. 作成／**ブランドを作成**&#x200B;をクリックします。

   1. **ページを作成**&#x200B;ウィザードから「**ブランド**」を選択し、「**次へ**」をクリックします。

   1. 「**タイトル**」に「**ContextHubDemo**」と入力し、「**作成**」をクリックします。これで、以下のようにブランドが作成されました。
   ![screen_shot_2019-05-05at44305pm](assets/screen_shot_2019-05-05at44305pm.png)

1. 

>[!CAUTION]
既知の問題：
領域を追加するには、URL（例えば下記）から「master」を削除します。
[https://localhost:4502/libs/cq/personalization/touch-ui/content/v2/activities.html/content/campaigns/contexthubdemo/master](https://localhost:4502/libs/cq/personalization/touch-ui/content/v2/activities.html/content/campaigns/contexthubdemo/master)

1. ブランドに領域を作成する

   1. **作成**／**領域を作成**&#x200B;をクリックします。

   1. ページを作成ウィザードから「**領域**」を選択し、「次へ」をクリックします。

   1. 「**タイトル**」に「**GoogleSheets**」と入力し、「**作成**」をクリックします。これで、アクティビティに領域が作成されます。

1. **オーディエンスにセグメントを作成する**

   1. AEM インスタンスで、**パーソナライゼーション**／**オーディエンス**／**We.Retail** に移動します。
   1. **作成**／**Context Hub セグメントを作成**&#x200B;をクリックします。新しい ContextHub セグメントダイアログボックスが開きます。
   1. 「**タイトル**」に「**SheetA1 1**」と入力し、「**作成**」をクリックします。同様に、「**SheetA2 2**」というタイトルの別のセグメントを作成します。

1. **セグメントを編集する**

   1. （上記手順で作成した）セグメント「**SheetA1 1**」を選択し、アクションバーの「**編集**」をクリックします。

   1. **比較 : プロパティ - 値**&#x200B;コンポーネントをエディターにドラッグ＆ドロップします。
   1. レンチアイコンをクリックして、**プロパティと値の比較**&#x200B;ダイアログボックスを開きます。
   1. 「**プロパティ名**」のドロップダウンから「**googlesheets/value/1/0**」を選択します。

   1. 「**演算子**」のドロップダウンメニューから「次と等しい」を選択します。

   1. 「**値**」に「**1**」を入力します。
   >[!NOTE]
   AEM で Google シートのデータが検証されると、セグメントが緑色で表示されます。

   ![screen_shot_2019-04-23at20142pm](assets/screen_shot_2019-04-23at20142pm.png)

   同様に、「**SheetA2 2**」セグメントのプロパティ値を編集します。

   1. **比較 : プロパティ - 値**&#x200B;コンポーネントをエディターにドラッグ＆ドロップします。
   1. レンチアイコンをクリックして、**プロパティと値の比較**&#x200B;ダイアログボックスを開きます。
   1. 「**プロパティ名**」のドロップダウンから「**googlesheets/value/1/0**」を選択します。

   1. 「**演算子**」のドロップダウンメニューから「次と等しい」を選択します。

   1. 「**値**」に「**2**」を入力します。
   >[!NOTE]
   上記の手順で適用したルールは、以下の使用例を実装するためのセグメントのセットアップ方法に関する例にすぎません。

## 手順 4：AEM Screens チャネルへの Context Hub 設定のセットアップ {#step-setting-up-context-hub-configurations-in-aem-screens-channel}

以下の手順に従って、ContextHub 設定と AEM Screens チャネルへのセグメントパスをセットアップします。

1. 前提条件として作成した AEM Screens チャネルの 1 つ（**DataDrivenRetail**）に移動します。
1. **DataDrivenRetail** チャネルを選択し、アクションバーの「**プロパティ**」をクリックします。

   ![screen_shot_2019-05-01at43332pm](assets/screen_shot_2019-05-01at43332pm.png)

1. 「**パーソナライゼーション**」タブを選択して、ContextHub 設定をセットアップします。

   1. 「**ContextHub のパス**」として **libs**/**settings**/**cloudsettings**/**legacy**/**contexthub** を選択し、「**選択**」をクリックします。

   1. 「**セグメントのパス**」として **conf**/we-retail/**settings**/**wcm**/**segments** を選択し、「**選択**」をクリックします。

   1. 「**保存して閉じる**」をクリックします。
   >[!NOTE]
   ContextHub 設定とセグメントをそれぞれ最初に保存した、Context Hub とセグメントのパスを使用します。

   ![screen_shot_2019-05-01at44030pm](assets/screen_shot_2019-05-01at44030pm.png)

   >[!NOTE]
   上記ダイアログボックスの「**ターゲティング設定**」で「**ブランド**」を選択しない場合は、ターゲティングプロセスを開始する際に、「ブランド」と「アクティビティ」を選択する必要があります。

1. **DataDrivenAssets**／Channels に移動して「**DataDrivenRetail**」を選択し、アクションバーの「**編集**」をクリックします。

   >[!NOTE]
   すべてを正しくセットアップしたら、下図に示すように、エディターのドロップダウンに「**ターゲティング**」オプションが表示されます。

   ![screen_shot_2019-05-01at44231pm](assets/screen_shot_2019-05-01at44231pm.png)

   >[!NOTE]
   チャネルの ContextHub 設定を完了したら、以下のすべての使用例に従う場合は、他の 3 つのシーケンスチャネルについても必ず上記の手順 1～4 に従ってください。

## 使用例 1：小売店向けの在庫に応じたアクティブ化 {#use-case-retail-inventory-activation}

次の使用例では、Google シートの値に応じた 3 種類の画像の表示方法を示しています。

### 説明 {#description}

この使用例は、3 種類のカラートレーナーの小売在庫を表示します。Google シートに記録されているトレーナーの在庫数に応じて、最も数が多いトレーナー（赤、緑、青のいずれか）の画像がスクリーンに表示されます。

この使用例では、赤、緑、青の 3 色のうち、在庫数の最も多いトレーナーがスクリーンに表示されます。

### 手順 {#procedure}

「小売店向けの在庫に応じたアクティブ化」の使用例を実装するには、以下の手順に従います。

1. **Google シートにデータを入力する**

   1. ContextHubDemo Google シートに移動します。
   1. 3 種類のトレーナーに対応する値を格納する 3 つの列（Red、Green、Blue）を追加します。
   ![screen_shot_2019-05-06at101755am](assets/screen_shot_2019-05-06at101755am.png)

1. **要件に従ってオーディエンスを設定する**

   1. （***手順 3：Google シートのコンテンツを取得するための AEM の設定***&#x200B;で作成した）オーディエンスのセグメントに移動します。
   1. 3 つの新しいセグメント **For_Red**、**For_Green**、**For_Blue** を追加します。

   1. 「**For_Red**」を選択し、アクションバーの「**編集**」をクリックします。

   1. **比較 : プロパティ - プロパティ**&#x200B;コンポーネントをエディターにドラッグ＆ドロップし、設定アイコンをクリックしてプロパティを編集します。
   1. 「**1 つめのプロパティの名前**」のドロップダウンから「**googlesheets/value/1/2**」を選択します。

   1. 「**演算子**」のドロップダウンメニューから「次よりも大きい」を選択します。

   1. 「**データタイプ**」として「**数値**」を選択します。

   1. 「**2 つめのプロパティの名前**」のドロップダウンから「**googlesheets/value/1/1**」を選択します。

   1. 別の「比較 : プロパティ - プロパティ」コンポーネントをエディターにドラッグ＆ドロップし、設定アイコンをクリックしてプロパティを編集します。
   1. 「**1 つめのプロパティの名前**」のドロップダウンから「**googlesheets/value/1/2**」を選択します。

   1. 「**演算子**」のドロップダウンメニューから「次よりも大きい」を選択します。

   1. 「**データタイプ**」として「**数値**」を選択します。

   1. 「**2 つめのプロパティの名前**」のドロップダウンから「**googlesheets/value/1/0**」を選択します。
   ![screen_shot_2019-05-06at102600am](assets/screen_shot_2019-05-06at102600am.png)

   同様に、**For_Blue** セグメントにプロパティ比較ルールを追加し編集します（下図を参照）。

   ![screen_shot_2019-05-06at103728am](assets/screen_shot_2019-05-06at103728am.png)

   同様に、For_Green セグメントにプロパティ比較ルールを追加し編集します（下図を参照）。

   ![screen_shot_2019-05-06at103418am](assets/screen_shot_2019-05-06at103418am.png)

   >[!NOTE]
   Google シートの値どおり、現時点では最初の比較のみ有効なので、セグメント **For_Blue** および **For_Green** については、データをエディターに読み込むことはできません。

1. DataDrivenRetail チャネル（シーケンスチャネル）に移動して選択し、アクションバーの「**編集**」をクリックします。

   ![screen_shot_2019-05-06at104257am](assets/screen_shot_2019-05-06at104257am.png)

   >[!CAUTION]
   チャネルの&#x200B;**プロパティ**&#x200B;を開き、「**パーソナライズ機能**」タブを使用して「**ContextHub** **設定**」をセットアップしておいてください。

   ![screen_shot_2019-05-06at105214am](assets/screen_shot_2019-05-06at105214am.png)

   >[!NOTE]
   プロジェクトの「**ContextHub 設定**」をセットアップする際に「**ターゲティング設定**」で「**ブランド**」を追加しない場合（上記の画像を参照）は、次の手順でターゲティングプロセスを開始する際に、「**ブランド**」と「**アクティビティ**」を選択する必要があります。

1. **デフォルト画像を追加する**

   1. チャネルにデフォルト画像を追加し、「**ターゲット設定**」をクリックします。
   1. 「**ブランド**」と「**アクティビティ**」のドロップダウンメニューから選択し、「**ターゲット設定を開始**」をクリックします。

   1. 「**ターゲット設定を開始**」をクリックします。
   ![screen_shot_2019-05-06at121253pm](assets/screen_shot_2019-05-06at121253pm.png)

   >[!NOTE]
   ターゲット設定を開始する前に、サイドレールの「**+ エクスペリエンスのターゲットを追加**」をクリックして、セグメント（**For_Green**、**For_Red**、**For_Blue**）を追加する必要があります（下図を参照）。

   ![screen_shot_2019-05-06at123554pm](assets/screen_shot_2019-05-06at123554pm.png)

1. 以下に示すように、3 つの異なるシナリオすべてに画像を追加します。

   ![retail_targeting](assets/retail_targeting.gif)

1. **プレビューを確認する**

   1. 「**プレビュー**」をクリックします。また、Google シートを開き、値を更新します。
   1. 3 つの異なる列の値をすべて変更すると、在庫の最大数に応じてディスプレイ画像が更新されます。
   ![retail_result](assets/retail_result.gif)

## 使用例 2：旅行センター向けの天候に応じたアクティブ化 {#use-case-travel-center-weather-activation}

次の使用例では、Google シートの値に応じた 2 種類の画像の表示方法を示しています。

### 説明 {#description-1}

この使用例では、Google シートの値が 50 未満の場合は、暖かい飲み物の画像が表示され、値が 50 以上の場合は冷たい飲み物の画像が表示されます。それ以外の値の場合や値がない場合は、デフォルト画像がプレーヤーに表示されます。

### 手順 {#procedure-1}

AEM Screens プロジェクトに「旅行センター向けの天候に応じたアクティブ化」の使用例を実装するには、以下の手順に従います。

1. **Google シートにデータを入力する**

   1. ContextHubDemo Google シートに移動します。
   1. 気温に対応する値を格納する **Heading1** という列を追加します。
   ![screen_shot_2019-05-08at112911am](assets/screen_shot_2019-05-08at112911am.png)

1. **要件に従ってオーディエンスのセグメントを設定する**

   1. （***手順 3：Google シートのコンテンツを取得するための AEM の設定***&#x200B;で作成した）オーディエンスのセグメントに移動します。
   1. 「**Sheets A1 1**」を選択し、「**編集**」をクリックします。

   1. 比較プロパティを選択し、設定アイコンをクリックしてプロパティを編集します。
   1. 「**プロパティ名**」のドロップダウンから「**googlesheets/value/1/0**」を選択します。

   1. 「**演算子**」のドロップダウンメニューから「次よりも大きいか等しい」を選択します。

   1. 「**値**」に「**50**」を入力します。

   1. 同様に、「Sheets A1 2」を選択し、「**編集**」をクリックします。

   1. 比較プロパティを選択し、設定アイコンをクリックしてプロパティを編集します。
   1. 「**プロパティ名**」のドロップダウンから「**googlesheets/value/1/0**」を選択します。

   1. 「**演算子**」のドロップダウンメニューから「次よりも小さい」を選択します。

   1. 「**値**」に「**50**」を入力します。

1. チャネルに移動して選択し、アクションバーの「**編集**」をクリックします。次の例では、**DataDrivenWeather** というシーケンスチャネルを使用して機能を紹介しています。

   >[!NOTE]
   チャネルには既にデフォルト画像が存在し、手順 4 で説明しているとおりにオーディエンスが事前設定されています。

   ![screen_shot_2019-05-08at113022am](assets/screen_shot_2019-05-08at113022am.png)

   >[!CAUTION]
   チャネルの&#x200B;**プロパティ**&#x200B;を開き、「**パーソナライズ機能**」タブを使用して「**ContextHub** **設定**」をセットアップしておいてください。

   ![screen_shot_2019-05-08at114106am](assets/screen_shot_2019-05-08at114106am.png)

   >[!NOTE]
   プロジェクトの「**ContextHub 設定**」をセットアップする際に「**ターゲティング設定**」で「**ブランド**」を追加しない場合（上記の画像を参照）は、次の手順でターゲティングプロセスを開始する際に、「**ブランド**」と「**アクティビティ**」を選択する必要があります。

1. エディターから「**ターゲット設定**」を選択し、「**ブランド**」を選択してドロップダウンメニューから「**アクティビティ**」を選択します。次に、「**ターゲット設定を開始**」をクリックします。

   >[!NOTE]
   プロジェクトの「**ContextHub 設定**」をセットアップする際に「**ターゲティング設定**」で「**ブランド**」を追加した場合は、この手順で「**ブランド**」と「**アクティビティ**」を選択する必要はありません。

   ![new_activity3](assets/new_activity3.gif)

1. プレビューを確認する

   1. 「**プレビュー**」をクリックします。また、Google シートを開き、値を更新します。
   1. 値を 50 未満に変更すると、暖かい飲み物の画像が表示されます。Google シートの値が 50 以上の場合は、冷たい飲み物の画像が表示されます。
   ![result3](assets/result3.gif)

## 使用例 3：接客業向けの予約状況に応じたアクティブ化 {#use-case-hospitality-reservation-activation}

次の使用例では、Google シートの値と適用される数式に応じた 2 種類の画像の表示方法を示します。

### 説明 {#description-2}

この使用例では、**Restarant1** および **Restarant2** という 2 つのレストランの予約率が Google シートに入力されています。Restarant1 と Restarant2 の値に基づいて数式が適用され、その数式に基づいて、値 1 または値 2 が **AdTarget** 列に割り当てられます。

**Restaurant1** の値が **Restaurant2** の値より大きい場合は、**AdTaget** の値が 1 になり、それ以外の場合は、**AdTarget** に値 2 が割り当てられます。値 1 の場合はディスプレイの画面に&#x200B;*ステーキ料理*&#x200B;のオプションが表示され、値 2 の場合は&#x200B;*タイ料理*&#x200B;のオプションが表示されます。

### 手順 {#procedural-approach}

AEM Screens プロジェクトに「接客業向けの予約状況に応じたアクティブ化」の使用例を実装するには、以下の手順に従います。

1. Google シートにデータを入力し数式を追加する

   例えば、3 列目の **AdTarget** に数式を適用します（下図を参照）。

   ![screen_shot_2019-04-29at94132am](assets/screen_shot_2019-04-29at94132am.png)

1. **要件に従ってオーディエンスのセグメントを設定する**

   1. （***手順 3：Google シートのコンテンツを取得するための AEM の設定***&#x200B;で作成した）オーディエンスのセグメントに移動します。
   1. 「**Sheets A1 1**」を選択し、「**編集**」をクリックします。

   1. 比較プロパティを選択し、設定アイコンをクリックしてプロパティを編集します。
   1. 「**プロパティ名**」のドロップダウンから「**googlesheets/value/1/2**」を選択します。

   1. 「**演算子**」のドロップダウンメニューから「次と等しい」を選択します。

   1. 「**値**」に「**1**」を入力します。

   1. 同様に、「Sheets A1 2」を選択し、「**編集**」をクリックします。

   1. 比較プロパティを選択し、設定アイコンをクリックしてプロパティを編集します。
   1. 「**プロパティ名**」のドロップダウンから「**googlesheets/value/1/2**」を選択します。

   1. 「**演算子**」として「**2**」を選択します。

1. チャネルに移動して選択し、アクションバーの「**編集**」をクリックします。次の例では、**DataDrivenRestarant** というシーケンスチャネルを使用して機能を紹介しています。

   >[!NOTE]
   チャネルには既にデフォルト画像が存在し、手順 4 で説明しているとおりにオーディエンスが事前設定されています。

   ![screen_shot_2019-05-08at14652pm](assets/screen_shot_2019-05-08at14652pm.png)

   >[!CAUTION]
   チャネルの&#x200B;**プロパティ**&#x200B;を開き、「**パーソナライズ機能**」タブを使用して「**ContextHub** **設定**」をセットアップしておいてください。

   ![screen_shot_2019-05-08at14903pm](assets/screen_shot_2019-05-08at14903pm.png)

   >[!NOTE]
   プロジェクトの「**ContextHub 設定**」をセットアップする際に「**ターゲティング設定**」で「**ブランド**」を追加しない場合（上記の画像を参照）は、次の手順でターゲティングプロセスを開始する際に、「**ブランド**」と「**アクティビティ**」を選択する必要があります。

1. エディターから「**ターゲット設定**」を選択し、「**ブランド**」を選択してドロップダウンメニューから「**アクティビティ**」を選択します。次に、「**ターゲット設定を開始**」をクリックします。
1. プレビューを確認する

   1. 「**プレビュー**」をクリックします。また、Google シートを開き、値を更新します。
   1. 値が Restarant1 &gt; Restarant2 の場合は、スクリーンにステーキの画像が表示され、Restarant1 &lt; Restaurant2 の場合は、タイ料理の画像が表示されます。
   ![result5](assets/result5.gif)

## 使用例 4：テキストオーバーレイ対応デジタルメニューボード {#use-case-digital-menu-board-text-overlay}

次の使用例は、レストランやファストフード店で普及しているデジタルメニューボードの例です。

### 説明 {#description-3}

次の使用例では、シーケンスチャネルでのテキストオーバーレイの使用方法と、Google シートに入力されている価格データの更新でテキストオーバーレイコンポーネントの更新をトリガーする方法について説明します。

### 手順 {#procedural-approach-1}

AEM Screens プロジェクトに「テキストオーバーレイ対応デジタルメニューボード」の使用例を実装するには、以下の手順に従います。

1. **Google シートにデータを入力する**

   1. Google シートに移動します。
   1. ユースケースに必要な価格データを格納する列を追加します（下図を参照）。
   ![screen_shot_2019-05-05at111344am](assets/screen_shot_2019-05-05at111344am.png)

1. **シーケンスチャネルに画像を追加する**

   1. チャネル（**DataDrivenAssets**／**Channels**／**DataDrivenTextOverlay**）に移動して選択します。

   1. アクションバーの「**編集**」をクリックして、エディターを開きます。
   1. エディターにアップルパイの画像をドラッグ＆ドロップします。
   ![screen_shot_2019-05-05at112933am](assets/screen_shot_2019-05-05at112933am.png)

1. **画像にテキストオーバーレイを追加する**

   1. エディターで画像を選択し、「設定」をクリックします。
   1. 「**テキストオーバーレイ**」タブに移動し、画像にテキストオーバーレイを追加します。Google シートから値を取得するには、値を中括弧 {} で囲む必要があります。例えば、価格は Google シートから取得され、テキストオーバーレイの定義時に **{price}** という表記で言及されます。

   1. 「**ContextHub**」タブに移動し、Google シートから取得する値を設定します。
   ![textoverlay_result](assets/textoverlay_result.gif)

1. **プレビューを確認する**

   <!-- Edit text in steps below. wonky-->

   1. 「**プレビュー**」をクリックします。また、Google シートを開き、値を更新します。
   1. **Price** 列の値を変更すると、テキストオーバーレイで使用されている値が、それに応じて更新されます（下図を参照）。
   ![textoverlay_result-1](assets/textoverlay_result-1.gif)
